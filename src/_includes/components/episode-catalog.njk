<main class="episode-list">
  {# This is the new, flat structure for each episode row #}
  {% for post in collections.episodes | reverse %}
    {% set ep_data = post.data %}

    {# Define display variables with override logic #}
    {% set final_title = ep_data.displayTitleOverride or ep_data.displayTitle %}
    {% set guest_display_name = ep_data.guestDisplayName or ep_data.guest %}
    {% set guest_short_name = ep_data.guestShortName or ep_data.guest %}
    {% set final_preposition = ep_data.guestPreposition or "w/" %}
    
    {% set has_guest_info = guest_display_name and guest_display_name != 'null' %}

    <a href="{{ post.url | url }}" class="episode-row{% if not has_guest_info %} no-guest{% endif %}">
      {# Flat structure for direct grid control #}
      <span class="episode-number">{{ (ep_data.episodeNumber | string) | padStart(2, '0') }}</span>

      {# This main content block is a grid item itself on desktop #}
      <div class="episode-main">
        <h2 class="episode-title">
          <span class="episode-title-display">{{ final_title }}</span>
          <span class="episode-title-original">{{ final_title }}{% if has_guest_info %} {{ final_preposition }} {{ guest_display_name }}{% endif %}</span>
        </h2>
        <p class="episode-desc roboto-slant">{{ ep_data.subtitle }}</p>
      </div>
      
      {# Metadata elements for mobile and desktop #}
      <span class="episode-guest-w">{{ final_preposition }}</span>
      <span class="episode-guest-name">{{ guest_short_name }}</span>
      <span class="episode-date">{{ ep_data.date | date('MM/dd/yy') }}</span>
      <span class="episode-duration">{{ ep_data.duration | formatDuration }}</span>
    </a>
  {% endfor %}
</main> 